<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Překlad</title>
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 40px; }
    h1 { text-align: center; }
    .progress-wrapper { max-width: 600px; margin: 40px auto; text-align:center; background:#fff; padding:25px 30px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    progress { width: 100%; height: 20px; }
    .results { max-width: 600px; margin: 30px auto; background:#fff; padding:25px 30px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    a.download-link { background:#28a745; color:white; padding:8px 15px; border-radius:5px; text-decoration:none; }
    a.download-link:hover { background:#1e7e34; }
  </style>
</head>
<body>
  <h1>Překlad probíhá</h1>
  <div class="progress-wrapper">
    <progress id="bar" value="0" max="100"></progress>
    <p id="status">0%</p>
  </div>
  <div id="done" class="results" style="display:none;">
    <h2>✅ Překlad dokončen</h2>
    <ul id="links"></ul>
  </div>
  <script>
    const jobId = "{{ job_id }}";
    function update() {
      fetch('/progress/' + jobId)
        .then(r => r.json())
        .then(data => {
          const pct = data.percent || 0;
          document.getElementById('bar').value = pct;
          document.getElementById('status').textContent = pct + '%';
          if (data.links) {
            const ul = document.getElementById('links');
            ul.innerHTML = '';
            data.links.forEach(l => {
              const li = document.createElement('li');
              li.innerHTML = `<strong>${l[0]}</strong>: <a class="download-link" href="${l[1]}">Stáhnout</a>`;
              ul.appendChild(li);
            });
            document.getElementById('done').style.display = 'block';
            clearInterval(timer);
          }
        });
    }
    const timer = setInterval(update, 1000);
    update();
  </script>
</body>
</html>
